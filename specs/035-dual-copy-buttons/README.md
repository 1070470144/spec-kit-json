# 035: 双复制按钮 - 内容 + 地址

## 状态
✅ **已完成** (2025-10-11)

## 需求
提供两种复制方式，满足不同网站的导入需求：
1. **复制 JSON 内容** - 直接复制JSON字符串，适合支持粘贴的网站
2. **复制 JSON 地址** - 复制URL链接，适合要求输入地址的网站（如血染钟楼官网）

## 背景

血染钟楼官网的"载入自定义剧本/角色"功能要求**输入custom-script.json文件的地址**，而不是粘贴JSON内容。因此需要同时提供两种复制方式。

## 解决方案

### 按钮布局

```
┌────────────────────────────────────────────────────────────┐
│ [下载 JSON] [复制JSON内容] [复制JSON地址] [返回列表]     │
│              ↑ 复制内容      ↑ 复制URL                     │
└────────────────────────────────────────────────────────────┘
```

### 两个按钮

#### 1. 复制 JSON 内容
- **功能**: 获取JSON数据 → 格式化 → 复制字符串
- **适用**: 支持粘贴JSON内容的网站
- **图标**: 📋 复制图标
- **状态**: 
  - 默认: "复制 JSON 内容"
  - 加载中: "加载中..."
  - 成功: "已复制内容！"

#### 2. 复制 JSON 地址
- **功能**: 直接复制URL链接
- **适用**: 要求输入地址的网站（如血染钟楼官网）
- **图标**: 🔗 链接图标
- **状态**:
  - 默认: "复制 JSON 地址"
  - 成功: "已复制地址！"

### URL 格式

```
https://yourdomain.com/api/scripts/{scriptId}.json
```

**说明：**
- URL格式类似 `custom-script.json`，符合血染钟楼官网的要求
- 以`.json`结尾，网站可以识别这是一个JSON文件
- 服务器返回纯JSON数据
- HTTP响应头设置为 `Content-Type: application/json`

## 使用场景

### 场景 1: 血染钟楼官网（要求输入地址）⭐

1. 点击"**复制 JSON 地址**"
2. 看到提示"已复制地址！"
3. 打开血染钟楼官网
4. 点击"载入自定义 剧本/角色"
5. 在"输入custom-script.json文件的地址"输入框中**粘贴**
6. 点击"确定"
7. 完成导入！

**复制的地址示例：**
```
https://yourdomain.com/api/scripts/cle1234567890.json
```

✅ URL格式类似 `custom-script.json`，完美符合血染钟楼官网的要求

### 场景 2: 其他支持粘贴的网站

1. 点击"**复制 JSON 内容**"
2. 打开目标网站
3. 直接**粘贴JSON内容**
4. 完成导入！

## 技术实现

### 文件结构

**新文件:** `app/scripts/[id]/CopyJsonButtons.tsx`

包含三个组件：
- `CopyJsonContentButton` - 复制JSON内容
- `CopyJsonUrlButton` - 复制JSON地址
- `CopyJsonButtons` - 组合导出（默认）

### 核心逻辑

**复制内容：**
```typescript
fetch(`${baseUrl}/api/scripts/${scriptId}/download`)
  → response.json()
  → JSON.stringify(data, null, 2)
  → navigator.clipboard.writeText(jsonString)
```

**复制地址：**
```typescript
const url = `${baseUrl}/api/scripts/${scriptId}/download`
navigator.clipboard.writeText(url)
```

## 对比

| 功能 | 复制内容 | 复制地址 |
|------|----------|----------|
| **复制内容** | JSON字符串 | URL地址 |
| **需要网络** | 是（获取JSON） | 否 |
| **加载时间** | ~1秒 | 即时 |
| **适用场景** | 粘贴导入 | URL导入 |
| **血染钟楼官网** | ❌ 不适用 | ✅ 适用 |
| **其他网站** | ✅ 可能适用 | ⚠️ 看网站支持 |

## 文件清单

### 新增
- `app/scripts/[id]/CopyJsonButtons.tsx` ✅

### 修改
- `app/scripts/[id]/page.tsx` ✅（导入新组件）

### 保留
- `app/scripts/[id]/CopyJsonUrlButton.tsx`（旧文件，可选删除）

## 视觉效果

### 桌面端
```
┌───────────────────────────────────────────────────────┐
│ [下载 JSON]  [复制JSON内容]  [复制JSON地址]  [返回]  │
└───────────────────────────────────────────────────────┘
```

### 移动端
```
┌──────────────────┐
│ [下载 JSON]      │
│ [复制JSON内容]   │
│ [复制JSON地址]   │
│ [返回列表]       │
└──────────────────┘
```

## 成功标准

- [x] 两个按钮并排显示 ✅
- [x] "复制JSON内容"功能正常 ✅
- [x] "复制JSON地址"功能正常 ✅
- [x] 状态反馈清晰 ✅
- [x] 响应式布局 ✅
- [x] 满足血染钟楼官网需求 ✅

## 优势

1. **兼容性更好** - 同时支持两种导入方式
2. **用户选择** - 根据目标网站选择合适的按钮
3. **清晰标识** - 按钮文本明确说明功能
4. **独立状态** - 两个按钮状态互不干扰

